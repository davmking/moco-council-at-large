---
title: "MoCo Council At-Large Election 2022"
author: "Dav King"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = F, message = F)
```

```{r libraries}
library(tidyverse)
library(corrplot)
```

Create data:

```{r data}
precinct <- read.csv("GP22_16PrecinctsDemocratic.csv")
councilAL <- precinct %>% 
  filter(Office.Name == "County Council At Large") %>% 
  mutate(total.votes = Early.Votes + Election.Night.Votes +
           Mail.In.Ballot.1.Votes + Provisional.Votes + Mail.In.Ballot.2.Votes)
```

Correlation plot - total votes, county council at-large

```{r correlations between councilmembers}
councilWide <- councilAL %>% 
  select(Election.District...Precinct, Candidate.Name, total.votes) %>% 
  pivot_wider(names_from = Candidate.Name, values_from = total.votes) %>% 
  rename(Albornoz = `Gabe Albornoz`, Brooks = `Brandy H. M. Brooks`,
         Gassaway = `Dana E. Gassaway`, Glass = `Evan Glass`, Goldberg = 
         `Scott Evan Goldberg`, Hucker = `Tom Hucker`, Jawando = `Will Jawando`,
         Sayles = `Laurie-Anne Sayles`)
mat <- councilWide %>% 
  select(-Election.District...Precinct) %>% 
  cor()
#spearmat <- councilWide %>% 
  #select(-Election.District...Precinct) %>% 
  #cor(method = "s")
corrplot.mixed(mat, order = "hclust")
#corrplot.mixed(spearmat, order = "hclust")
```

```{r correlations between at-large and districts}
councilDistrict <- precinct %>% 
  filter(Office.Name == "County Council") %>% 
  mutate(total.votes = Early.Votes + Election.Night.Votes +
           Mail.In.Ballot.1.Votes + Provisional.Votes +
           Mail.In.Ballot.2.Votes) %>% 
  select(Election.District...Precinct, Office.District,
         Candidate.Name, total.votes) %>% 
  pivot_wider(names_from = Candidate.Name, values_from = total.votes)
councilFull <- councilWide %>% 
  full_join(councilDistrict)
```

```{r district 2 correlations}
council1 <- councilFull %>% 
  filter(Office.District == "002") %>% 
  select(Albornoz, Brooks, Gassaway, Glass, Goldberg, Hucker, Jawando, Sayles,
         `Marilyn Balcombe`, `Lorna Phillips Forde`, `William Roberts`) %>% 
  rename(Balcombe = `Marilyn Balcombe`, Forde = `Lorna Phillips Forde`, 
         Roberts = `William Roberts`)
c1cor <- cor(council1)
#c1spear <- cor(council1, method = "s")
corrplot.mixed(c1cor)
#corrplot.mixed(c1spear)
```

